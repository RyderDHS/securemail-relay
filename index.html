<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Secure Message Relay</title>
</head>
<body>
<script>
(function () {
  const params = new URLSearchParams(window.location.search);
  const action = decodeURIComponent(params.get('a') || '');
  const payloadB64 = params.get('p') || '';

  if (!action || !payloadB64) {
    document.body.textContent = 'Missing parameters.';
    return;
  }

  const payload = atob(payloadB64); // x-www-form-urlencoded: k=v&k2=v2...

  const form = document.createElement('form');
  form.method = 'POST';
  form.action = action;
  document.body.appendChild(form);

  // Crear inputs a partir de k=v&k2=v2...
  payload.split('&').forEach(kv => {
    const [k, v] = kv.split('=');
    if (k) {
      const input = document.createElement('input');
      input.type  = 'hidden';
      input.name  = decodeURIComponent(k);
      input.value = decodeURIComponent(v || '');
      form.appendChild(input);
    }
  });

  form.submit();
})();
</script>
</body>
</html>
